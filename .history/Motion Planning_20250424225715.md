# Mobile Robots

[å¯è§†åŒ–Python](https://github.com/zhm-real/PathPlanning)

[MRPT](https://docs.mrpt.org/reference/latest/index.html)

## Chapter 1 Mapping

### 1.structure

<img src="./Motion Planning.assets/image-20250417095645143.png" alt="image-20250417095645143" style="zoom: 50%;" />

### 2.Occupancy grid map 

[grid map code](https://github.com/ANYbotics/grid_map)

* åŸç†ï¼šå°†å¹³é¢åœ°å›¾é€šè¿‡gridè¿›è¡Œåˆ†å‰²ï¼Œæ¯ä¸ªæ …æ ¼ç”¨0,1è¡¨ç¤ºï¼ˆ0 - freeï¼Œ1 - occupiedï¼‰

  ![image-20250418120646301](./Motion Planning.assets/image-20250418120646301.png)

* Notation Defination

![image-20250418121448522](./Motion Planning.assets/image-20250418121448522.png)

<img src="./Motion Planning.assets/image-20250418122148617.png" alt="image-20250418122148617" style="zoom: 80%;" />

* Recursive Update

ğŸ™Œæ¨å¯¼ï¼šç”±è´å¶æ–¯å…¬å¼ï¼š
$$
\begin{aligned}p(m_{i}|z_{1:t}) & =\frac{p(z_{t}|z_{1:t-1},m_{i})p(m_{i}|z_{1:t-1})}{p(z_{t}|z_{1:t-1})}\\  & \left(é©¬å°”ç§‘å¤«è¿‡ç¨‹\right)=\frac{p(z_{t}|m_{i})p(m_{i}|z_{1:t-1})}{p(z_{t}|z_{1:t-1})}\\  & (è´å¶æ–¯å±•å¼€)=\frac{p(m_{i}|z_{t})p(z_{t})}{p(m_{i})}\frac{p(m_{i}|z_{1:t-1})}{p(z_{t}|z_{1:t-1})}\end{aligned}
$$

$$
p(\overline{m_i}|z_{1:t})=\frac{p(\overline{m_i}|z_t)p(z_t)}{p(\overline{m_i})}\frac{p(\overline{m_i}|z_{1:t-1})}{p(z_t|z_{1:t-1})}
$$

 å¯¹ä¸Šè¿°ä¸¤å¼ç›¸é™¤ï¼Œå¹¶å–logï¼š
$$
\log\frac{p(m_i|z_{1:t})}{p(\overline{m_i}|z_{1:t})}=\log\frac{p(m_i|z_t)}{p(\overline{m_i}|z_t)}\frac{p(\overline{m_i})}{p(m_i)}\frac{p(m_i|z_{1:t-1})}{p(\overline{m_i}|z_{1:t-1})}
$$
é€’å½’æ›´æ–°è¡¨è¾¾å¼ï¼šï¼ˆåŒ–ç®€log -> lï¼‰
$$
l_{t}(m_{i})=\log\frac{p(m_{i}|z_{t})}{p(\overline{m_{i}}|z_{t})}-l_0(m_i)+l_{t-1}(m_{i})
$$
å…¶ä¸­ï¼Œ

P(z|m)æ˜¯ä¼ æ„Ÿå™¨æ¨¡å‹ - è¡¨ç¤ºåŸºäºå½“å‰æ …æ ¼çŠ¶æ€å¾—åˆ°å½“å‰è§‚æµ‹å€¼ä¸º0/1çš„æ¦‚ç‡

P(m|z)æ˜¯é€†ä¼ æ„Ÿå™¨æ¨¡å‹ï¼Œä¸ºäº†çº¦å»å®ƒï¼Œåšå¦‚ä¸‹å˜æ¢ï¼Œå¹¶å¸¦å…¥åˆ°é€’å½’æ›´æ–°è¡¨è¾¾å¼ä¸­ï¼š
$$
\begin{cases}p(m_i|z_t)=\frac{p(z_t|m_i)p(m_i)}{p(z_t)}\\p(\overline{m_i}|z_t)=\frac{p(z_t|\overline{m_i})p(\overline{m_i})}{p(z_t)}&\end{cases}
$$

$$
\log\frac{p(m_i|z_t)}{p(\overline{m_i|z_t})}=\log\frac{p(z_t|m_i)}{p(z_t|\overline{m_i})}+l_0(m_i)
$$

$$
âœ¨l_t(m_i)=\log\frac{p(z_t|m_i)}{p(z_t|\overline{m_i})}+l_{t-1}(m_i)
$$

![image-20250418210446286](./Motion Planning.assets/image-20250418210446286.png)

ï¼ˆç”±äºä¸Šè¿°ä¸¤ä¸ªå€¼å‡æ˜¯å¸¸é‡ï¼Œå› æ­¤âœ¨çœ‹ä½œæ˜¯ç®€å•çš„åŠ å’Œè¿ç®—ï¼‰



ğŸ¤”å‡½æ•°åˆ†æï¼š
$$
l_t(m_i)=\log\frac{p(m_i|z_{1:t})}{p(\overline{m_i}|z_{1:t})}=\log\frac{p(m_i|z_{1:t})}{1-p(m_i|z_{1:t})}
$$
<img src="./Motion Planning.assets/image-20250418211554907.png" alt="image-20250418211554907" style="zoom: 80%;" />



### 3.Octo mapï¼ˆåŸºäºå…«å‰æ ‘ï¼‰

[OctoMap code](https://github.com/OctoMap/octomap)



### 4.Voxel Hashing 

[VoxelHashing](https://github.com/niessner/VoxelHashing)

<img src="./Motion Planning.assets/image-20250418025053216.png" alt="image-20250418025053216" style="zoom: 67%;" />

### 5.PointCloud Map



### 6.TSDF map(Truncated Signed Distance Function) 

[OpenChisel.](https://github.com/personalrobotics/OpenChisel)

* æ¦‚è¿°ï¼šä¸€ä¸ªä¸‰ç»´çš„TSDFæ¨¡å‹ç”± LÃ—WÃ—H ä¸ªä¸‰ç»´å°æ–¹å—ç»„æˆï¼Œè¿™äº›ä¸‰ç»´å°æ–¹å—è¢«ç§°ä¸º[ä½“ç´ ](https://zhida.zhihu.com/search?content_id=234249343&content_type=Article&match_order=1&q=ä½“ç´ &zhida_source=entity)ï¼ˆVoxelï¼‰ã€‚æ¯ä¸ªä½“			ç´ å†…åŒ…å«ä¸¤ä¸ªå˜é‡ï¼Œä¸€æ˜¯ç”¨äºç”Ÿæˆé‡å»ºè¡¨é¢çš„**tsdfå€¼**ï¼ŒäºŒæ˜¯ç”¨äºé‡å»ºè¡¨é¢è´´çº¹ç†çš„**RGBå€¼**ã€‚

â€‹					è½¬æ¢ç‰©ç†åæ ‡ç³»åˆ°ä½“ç´ åæ ‡ç³»ï¼š**int (** ( x âˆ’ x0 ) / voxel.x , ( y âˆ’ y0 ) / voxel.y , ( z âˆ’ z0 ) / voxel.z **)** 



* è®¡ç®—æ­¥éª¤ï¼š
  
1. **åˆ’åˆ†ä½“ç´ ** 
   a. å»ºç«‹å®Œå…¨åŒ…å›´å¾…é‡å»ºç‰©ä½“çš„é•¿æ–¹ä½“åŒ…å›´ç›’  
   b. åˆ’åˆ†ç½‘ç»œä½“ç´ ï¼Œå¯¹åŒ…å›´ç›’åˆ’åˆ† n ç­‰åˆ†  

   ![image-20250422192802474](./Motion%20Planning.assets/image-20250422192802474.png)

2. **TSDF å€¼è®¡ç®—**
   a.TSDF å€¼çš„å‰èº«æ˜¯ SDF å€¼ï¼š  
   å¦‚ä¸‹å›¾ï¼Œç™½ç°è‰²çš„å°æ–¹æ ¼è¡¨ç¤º TSDF åœ°å›¾ä¸­çš„å„ä¸ªä½“ç´ ã€‚è“è‰²çš„ä¸‰è§’å½¢è¡¨ç¤ºç›¸æœºçš„è§†åœºèŒƒå›´ã€‚å›¾ä¸­é—´æœ‰ä¸€æ¡ç»¿è‰²çš„æˆªçº¿ï¼Œè¡¨ç¤ºä¸€ä¸ªç‰©ä½“çš„æˆªé¢ã€‚

      <img src="./Motion%20Planning.assets/v2-cd492bf5890102d89b5f026d3dfae3c8_1440w.jpg" alt="img" style="zoom: 80%;" />  

   b.è®¡ç®— $voxel$åœ¨**ç‰©ç†åæ ‡**ä¸‹çš„ä½ç½®ï¼š  
   è®°ä½“ç´ $x$åœ¨TSDFåœ°å›¾ä¸Šçš„åæ ‡ $(v_x, v_y, v_z)$, $x$åœ¨ç‰©ç†ä¸–ç•Œåæ ‡ç³»ä¸‹çš„ä½ç½®æ˜¯ï¼š  
   $$
   P_{x,wrd} = \big(x_0 + v_x \cdot \mathrm{voxel.x},~ y_0 + v_y \cdot \mathrm{voxel.y},~ z_0 + v_z \cdot \mathrm{voxel.z}\big)
   $$

   c.è®¡ç®—ä½“ç´ $x$åœ¨**ç›¸æœºåæ ‡**ç³»ä¸‹çš„ä½ç½®ï¼š  

   è®¾ç›¸æœºç›¸å¯¹äºç‰©ç†åæ ‡ç³»ä¸‹çš„ä½å§¿æ˜¯ \(R\) å’Œ \(T\)ï¼Œä½“ç´  \(x\) åœ¨ç›¸æœºåæ ‡ç³»ä¸‹çš„ä½ç½®æ˜¯ï¼š  
   $$
   P_{x,cam} = \mathbf{R}P_{x,wrd} + T
   $$

   d.è®¡ç®—ä½“ç´  $x$ç›¸å¯¹äº**ç›¸æœºçš„æ·±åº¦** $cam_z(x)$ï¼š  

   æ ¹æ®ç›¸æœºæˆåƒæ¨¡å‹  
   $$
   \mathrm{cam}_z(x) \cdot I_x = \mathbf{K}P_{x,cam}
   $$
      ï¼ˆ$K$ è¡¨ç¤ºç›¸æœºçš„å†…å‚æ•°çŸ©é˜µï¼Œ$I_x$ è¡¨ç¤ºä½“ç´ $x$æŠ•å½±åœ¨ç›¸æœºæˆåƒå¹³é¢ä¸‹çš„åƒç´ åæ ‡ï¼‰  

      æ²¿ç€ç›¸æœºçš„å…‰å¿ƒå’Œä½“ç´  \(x\) ä½œä¸€æ¡ç›´çº¿ï¼ˆå›¾ä¸­æ·±è“è‰²ç²—çº¿ï¼‰ï¼Œè¿™æ¡çº¿ä¼šä¸**ç‰©ä½“çš„æˆªé¢**æœ‰ä¸€ä¸ªäº¤ç‚¹ï¼Œè¿™ä¸ªäº¤ç‚¹è®°ä¸º \(P\) ç‚¹ã€‚\(P\) ç‚¹çš„æ·±åº¦è®°ä¸º \(d_P\)ã€‚è®°å½“å‰çš„**æ·±åº¦å›¾**ä¸º \(D\)ï¼Œåœ¨å®é™…è®¡ç®—ä¸­å– \(d_P = D(I_x)\)ã€‚é‚£ä¹ˆä½“ç´  \(x\) çš„ SDF å€¼å°±å¯ä»¥è®¡ç®—å‡ºæ¥ï¼š  
   $$
   \mathrm{sdf}(x) = d_P - d_x = D(I_x) - \mathrm{cam}_z(x)
   $$

   e. è®¡ç®— TSDF å€¼ï¼š  
   
      $sdf(x) > 0$è¡¨ç¤ºä½“ç´  \(x\) ä½äºç›¸æœºå’Œç‰©ä½“è¡¨é¢ä¹‹é—´ï¼›$sdf(x) < 0$è¡¨  ç¤ºä½“ç´  $x$ å¤„äºç‰©ä½“è¡¨é¢ä¹‹åã€‚  

      TSDF è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š  
   $$
   \mathrm{tsdf}(x) = \max[-1, \min(1, \mathrm{sdf}(x) / t)]
   $$

      **ç‰©ç†æ„ä¹‰å¦‚ä¸‹ï¼š**
      $t$å¯ä»¥çœ‹ä½œæ˜¯**ä½“ç´  $x$** å’Œ**æˆªé¢å¯¹åº”ç‚¹ $P$ æ·±åº¦**å·®å€¼çš„é˜ˆå€¼ã€‚å½“ä½“ç´ ç¦»è¡¨é¢éå¸¸è¿‘çš„æ—¶å€™ï¼ŒTSDF å€¼æ¥è¿‘äºé›¶ï¼›å½“ä½“ç´ ç¦»è¡¨é¢éå¸¸è¿œçš„æ—¶å€™ï¼ŒTSDF å€¼è¶‹äº 1 æˆ–è€… -1ã€‚åˆå§‹åŒ–æ—¶è®¾æ‰€æœ‰ä½“ç´ çš„ TSDF å€¼ä¸º 1ï¼Œç›¸å½“äºè¿™ä¸ª TSDF åœ°å›¾ä¸­æ²¡æœ‰ä»»ä½•è¡¨é¢ã€‚

3. **å½“å‰å¸§ä¸å…¨å±€èåˆç»“æœè¿›è¡Œèåˆ**




7. ESDF map [HKUST-Aerial-Robotics/FIESTA: Fast Incremental Euclidean Distance Fields for Online Motion Planning of Aerial Robots](https://github.com/HKUST-Aerial-Robotics/FIESTA)





## Chapter 2Â Path Finding

### 1.1 Search-based Method

### 1.2 Sampling-based Method

### 1.3



## Chapter 2 







# Autonomus Cars
